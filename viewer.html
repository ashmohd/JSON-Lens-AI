<!DOCTYPE html>
<html>
<head>
  <title>JSON Lens AI Viewer</title>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
  <div class="toolbar">
    <!-- Controls will go here -->
    <button id="toggle-raw">View Raw</button>
    <button id="theme-toggle">Toggle Theme</button>
    <button id="expand-all">Expand All</button>
    <button id="collapse-all">Collapse All</button>
    <input type="number" id="expand-level-input" value="1" min="0" title="Level to expand to" style="width: 40px; margin-left: 10px;">
    <button id="expand-to-level">Expand to Level</button>
    <button id="settings-button">Settings</button>
  </div>

  <div id="settings-popup" class="popup">
    <h3>Settings</h3>
    <label for="gemini-api-key">Gemini API Key:</label>
    <input type="text" id="gemini-api-key" placeholder="Enter Gemini API Key">
    <label for="gemini-model">Gemini Model:</label>
    <select id="gemini-model">
        <option value="gemini-pro">Gemini Pro</option>
        <option value="gemini-flash">Gemini Flash</option>
    </select>
    <button id="close-settings-popup">Close</button>
  </div>

  <div class="container">
    <div id="error-message" style="display:none; color:red;"></div>
    <div id="json-viewer">
      <!-- Formatted JSON will be rendered here -->
    </div>
    <textarea id="raw-json" style="display:none; width:100%; height: 300px;"></textarea>
  </div>
  <div class="ai-features">
    <h3>AI Insights</h3>
    <!-- AI controls (API key and model) are now in the settings popup -->
    <div>
      <button id="ai-summarize">Summarize JSON</button>
      <div id="ai-summary-output"></div>
    </div>
    <div>
      <input type="text" id="nlq-input" placeholder="Ask AI about this JSON...">
      <button id="nlq-submit">Submit Query</button>
      <div id="nlq-output"></div>
    </div>
    <div>
      <button id="ai-infer-schema">Infer Schema</button>
      <div id="ai-schema-output"></div>
    </div>
     <div>
      <button id="ai-explain-node">Explain Selected Node</button>
      <div id="ai-explain-output"></div>
    </div>
  </div>
  <script src="viewer.js"></script>
</body>
</html>
