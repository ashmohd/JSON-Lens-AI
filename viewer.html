<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>JSON Lens AI Viewer</title>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
  <div class="toolbar">
    <!-- Controls will go here -->
    <button id="toggle-raw">View Raw</button>
    <button id="theme-toggle">Toggle Theme</button>
    <button id="expand-all">Expand All</button>
    <button id="collapse-all">Collapse All</button>
    <input type="number" id="expand-level-input" value="1" min="0" title="Level to expand to" style="width: 40px; margin-left: 10px;">
    <button id="expand-to-level">Expand to Level</button>
    <input type="text" id="jump-to-path-input" placeholder="JSONPath e.g., $.data[0].name" style="margin-left: 15px; width: 220px;">
    <button id="jump-to-path-button">Jump</button>
    <button type="button" id="goto-ai-insights-button" style="margin-left: 15px;">Go to AI Insights</button>
    <button id="settings-button" style="margin-left: 15px;">AI Settings</button>
  </div>

  <div id="search-controls">
    <input type="text" id="search-term" placeholder="Search JSON...">
    <div class="search-options-group">
      <label class="search-label">Type:</label>
      <label><input type="radio" name="search-type" value="values" id="search-type-values" checked> Values</label>
      <label><input type="radio" name="search-type" value="keys" id="search-type-keys"> Keys</label>
      <label><input type="radio" name="search-type" value="both" id="search-type-both"> Both</label>
    </div>
    <div class="search-options-group">
      <label class="search-label">Options:</label>
      <label><input type="checkbox" id="search-case-sensitive"> Case Sensitive</label>
      <label><input type="checkbox" id="search-regex"> Use Regex</label>
      <!-- <label><input type="checkbox" id="filter-to-matches"> Filter view to matches</label> -->
    </div>
    <button id="search-button">Search</button>
    <button id="clear-search-button">Clear</button>
  </div>

  <div id="breadcrumb-container">
    <!-- Breadcrumbs will be populated here by viewer.js -->
  </div>

  <div id="settings-popup" class="popup">
    <h3>AI Settings</h3>
    <label for="gemini-api-key">Gemini API Key:</label>
    <input type="text" id="gemini-api-key" placeholder="Enter Gemini API Key">
    <label for="gemini-model">Gemini Model:</label>
    <select id="gemini-model">
        <option value="gemini-1.5-pro-preview-05-06">Gemini 1.5 Pro Preview (May 2024)</option>
        <option value="gemini-1.5-flash-preview-05-20">Gemini 1.5 Flash Preview (May 2024)</option>
        <option value="gemini-pro">Gemini 1.0 Pro</option>
        <option value="gemini-flash">Gemini 1.0 Flash</option>
        <option value="gemini-1.5-pro">Gemini 1.5 Pro (Latest)</option>
        <option value="gemini-1.5-flash">Gemini 1.5 Flash (Latest)</option>
        <option value="gemma-2b-instruct">Gemma 2B Instruct</option>
        <option value="gemma-7b-instruct">Gemma 7B Instruct</option>
    </select>
    <button type="button" id="view-model-info-button" class="info-button" style="margin-left: 10px; font-size: 0.8em; padding: 2px 6px;">View Model Details & Pricing</button>
    <hr>
    <label for="setting-font-size">Font Size (px):</label>
    <input type="number" id="setting-font-size" min="8" max="30" step="1">
    <label for="setting-indent-width">Indentation (px):</label>
    <input type="number" id="setting-indent-width" min="0" max="80" step="2">
    <button id="close-settings-popup">Close</button>
  </div>

  <div id="model-info-popup" class="popup" style="display:none;">
    <div class="popup-header">
      <h3>Gemini & Gemma Model Information</h3>
      <button type="button" id="close-model-info-popup" class="close-button">&times;</button>
    </div>
    <div class="popup-content" id="model-info-table-container">
      <p>Note: Pricing and context windows are subject to change. Always refer to the official Google Cloud documentation for the latest details. "Tokens" are roughly 4 characters for English text.</p>
      <table>
        <thead>
          <tr>
            <th>Model Name (Display)</th>
            <th>Model ID (API)</th>
            <th>Description</th>
            <th>Context Window</th>
            <th>Pricing (Per 1M Chars / 1k Chars Input)</th>
            <th>Use Case</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Gemini 1.5 Pro Preview</td>
            <td>gemini-1.5-pro-preview-05-06</td>
            <td>Latest 1.5 Pro model with long context and improved performance. (Preview)</td>
            <td>1M tokens (~4M chars)</td>
            <td>$7 / $0.00175 (up to 128k context); $14 / $0.0035 (over 128k context)</td>
            <td>Complex reasoning, multimodal, long context tasks</td>
          </tr>
          <tr>
            <td>Gemini 1.5 Flash Preview</td>
            <td>gemini-1.5-flash-preview-05-20</td>
            <td>Fastest 1.5 model, optimized for speed and cost. (Preview)</td>
            <td>1M tokens (~4M chars)</td>
            <td>$0.7 / $0.000175 (up to 128k context); $1.4 / $0.00035 (over 128k context)</td>
            <td>High volume, fast, multimodal tasks</td>
          </tr>
          <tr>
            <td>Gemini 1.5 Pro</td>
            <td>gemini-1.5-pro</td>
            <td>Latest stable 1.5 Pro model.</td>
            <td>1M tokens (~4M chars)</td>
            <td>$7 / $0.00175 (up to 128k context); $14 / $0.0035 (over 128k context)</td>
            <td>General purpose, complex tasks</td>
          </tr>
          <tr>
            <td>Gemini 1.5 Flash</td>
            <td>gemini-1.5-flash</td>
            <td>Latest stable 1.5 Flash model.</td>
            <td>1M tokens (~4M chars)</td>
             <td>$0.7 / $0.000175 (up to 128k context); $1.4 / $0.00035 (over 128k context)</td>
            <td>Speed and cost sensitive tasks</td>
          </tr>
           <tr>
            <td>Gemini 1.0 Pro</td>
            <td>gemini-pro</td>
            <td>Older generation, still capable.</td>
            <td>32k tokens (~128k chars)</td>
            <td>$0.5 / $0.000125</td>
            <td>General purpose, text-only</td>
          </tr>
          <tr>
            <td>Gemini 1.0 Flash</td>
            <td>gemini-flash</td>
            <td>Older generation, optimized for speed, text-only.</td>
            <td>32k tokens (~128k chars)</td>
            <td>(Pricing varies, check docs)</td>
            <td>Fast, text-only tasks</td>
          </tr>
          <tr>
            <td>Gemma 2B Instruct</td>
            <td>gemma-2b-instruct</td>
            <td>Lightweight, instruction-tuned open model by Google.</td>
            <td>8k tokens (~32k chars)</td>
            <td>(Typically self-hosted or via Vertex AI - check specific platform)</td>
            <td>Dialogue, instruction following, code generation</td>
          </tr>
          <tr>
            <td>Gemma 7B Instruct</td>
            <td>gemma-7b-instruct</td>
            <td>Larger, instruction-tuned open model by Google.</td>
            <td>8k tokens (~32k chars)</td>
            <td>(Typically self-hosted or via Vertex AI - check specific platform)</td>
            <td>Advanced dialogue, instruction following, code generation</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="container">
    <div id="error-message" style="display:none; color:red;"></div>
    <div id="json-viewer">
      <!-- Formatted JSON will be rendered here -->
    </div>
    <textarea id="raw-json" style="display:none; width:100%; height: 300px;"></textarea>
  </div>
  <div class="ai-features">
    <h3>AI Insights</h3>
    <!-- AI controls (API key and model) are now in the settings popup -->
    <div>
      <button id="ai-summarize" disabled>Summarize JSON</button>
      <div id="ai-summary-output"></div>
    </div>
    <div>
      <input type="text" id="nlq-input" placeholder="Ask AI about this JSON..." disabled>
      <button id="nlq-submit" disabled>Submit Query</button>
      <div id="nlq-output"></div>
    </div>
    <div>
      <button id="ai-infer-schema" disabled>Infer Schema</button>
      <div id="ai-schema-output"></div>
    </div>
     <div>
      <button id="ai-explain-node" disabled>Explain Selected Node</button>
      <div id="ai-explain-output"></div>
    </div>
  </div>
  <script src="viewer.js"></script>
</body>
</html>
